<!DOCTYPE html>
<html lang="de">
<head><title>MathCATjs</title></head>
<body>
<h1>MathCAT JS</h1>
<p>MathML input:</p>
<textarea id="mathmlInput" rows="10" cols="50"><math><mroot>
    <mn>94949</mn>
    <mn>3</mn>
</mroot></math></textarea>
<button id="speakaloud">speakaloud</button>
<hr>
<p>Speech:</p>
<p id="speech"></p>
<p>Rendering:</p>
<div id="mathmlRendering">
    <math><mroot>
        <mn>94949</mn>
        <mn>3</mn>
    </mroot></math>
</div>
<hr>
<p><a id="link" href="#">link to this display</a></p>
<p>See source on <a href="https://github.com/polx/MathCATjs">GitHub</a>.</p>
<script>
  // =============== DEMO, please don't re-use as is =====================
  window.mathmlInput = document.getElementById("mathmlInput")
  window.mathmlRendering = document.getElementById("mathmlRendering")
  window.speech = document.getElementById("speech")
  window.baseURL = location.href
  if(baseURL.indexOf('?')>-1) baseURL = baseURL.substring(0, baseURL.indexOf('?'))

  const speakIt = () => {
    mathmlRendering.innerHTML = mathmlInput.value
    speech.innerText = mathCAT.mathmlToSpeech(mathmlInput.value)
    document.getElementById("link").href = baseURL + "?lang=" + lang + "&mathml=" + encodeURIComponent(mathmlInput.value)
  }

  document.getElementById("speakaloud").addEventListener("click", speakIt)

  window.addEventListener("TrunkApplicationStarted", (evt) => {
    console.log("MathCAT started")
    const params = new URLSearchParams(location.search)
    window.lang = params.get("lang") || document.body.parentElement.lang  || "en"
    window.mathCAT = wasmBindings
    mathCAT.initMathCAT(lang)
    if(params.has("mathml"))  mathmlInput.value = params.get("mathml")
    speakIt()
  })
  // ============= please re-use the below and inspire from above =============
</script>
</body>
<!-- the built HTML file contains the references to the WASM, re-use this to
        integrate MathCAT in your application: e.g. listen to TrunkApplicationStarted
        then define a global mathCAT object.

        Then call initMathCAT with an object expressing preferences
        (e.g. {Language:"de", Verbosity:"Terse"} or just "en" or just nothing).
        Now you can call mathmlToSpeech(mathMLexpression)
</html>